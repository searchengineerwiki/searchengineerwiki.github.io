<!doctype html>
<html>
  <head>
    <title>Search Engineer Wiki</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Open+Sans&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/style.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
  </head>
  <body>
    <div class="container">
      <a class="backlink" href="/">&lt; back</a>
      <h1>Bit Tricks</h2>

      <h2 id="number-of-runs-of-1s-in-a-binary-number">Number of runs of 1s in a binary number</h2>
<p>This was an interesting point found in the <a href="https://arxiv.org/pdf/1603.06549.pdf">Roaring Bitmap
paper</a> that shows how to compute the
number of runs of 1 values in a binary number.</p>
<p>Taking the original number, you can left-shift it by 1, and then calulcate the
2nd value by bitwise 'and not'ing the result against the original value. This
will set a 1 bit for each run that existed. Then you can calculate the <a href="https://en.wikipedia.org/wiki/Hamming_weight">Hamming
Weight</a> of the result. On most
CPUs this will be a single <code>POPCNT</code> (pop count) instruction.</p>
<h3 id="example">Example</h3>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>let a = 0b000111000111000111000011     | 0b000111000111000111000011
</span><span>let b = a &lt;&lt; 1                         | 0b001110001110001110000110
</span><span>let c = b &amp; !a                         | 0b001000001000001000000100
</span><span>let d = popcnt(c)                      | 4
</span></code></pre>

    </div>
  </body>
</html>
